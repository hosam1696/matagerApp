{"version":3,"sources":["../../src/pages/reserve-shelf/reserve-shelf.module.ts","../../src/pages/reserve-shelf/reserve-shelf.ts"],"names":[],"mappings":"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","file":"16.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ReserveShelfPage } from './reserve-shelf';\r\nimport { HsaloaderComponentModule } from '../../components/hsa-loader/hsa-loader.module';\r\nimport { SinceDatePipeModule } from '../../app/service/since-date/since-date.module';\r\nimport {ArabicDatePipeModule} from \"../../app/service/arabic-date/arabic-date.module\";\r\n@NgModule({\r\n  declarations: [\r\n    ReserveShelfPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ReserveShelfPage),\r\n    HsaloaderComponentModule,\r\n    SinceDatePipeModule,\r\n    ArabicDatePipeModule\r\n  ],\r\n  exports: [\r\n    ReserveShelfPage\r\n  ]\r\n})\r\nexport class ReserveShelfPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/reserve-shelf/reserve-shelf.module.ts","import {Component} from '@angular/core';\r\nimport {IonicPage, NavController, ToastController, NavParams} from 'ionic-angular';\r\n\r\nimport {ShelfsProvider} from '../../providers/shelfs';\r\nimport {NotificationsProvider} from '../../providers/notifications';\r\nimport {INotification, shelfRequestInfo} from '../../app/service/interfaces';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-reserve-shelf',\r\n  templateUrl: 'reserve-shelf.html',\r\n})\r\nexport class ReserveShelfPage {\r\n  pageData: INotification;\r\n  shelfData: shelfRequestInfo;\r\n  showShelfList: boolean = false;\r\n  showLoader: boolean = false;\r\n  salesPercentage: any;\r\n  noShelf: boolean = false;\r\n  userLocal = JSON.parse(localStorage.getItem('userLocalData'));\r\n\r\n  constructor(public navCtrl: NavController,\r\n              public navParams: NavParams,\r\n              public shelfProvider: ShelfsProvider,\r\n              public toastCtrl: ToastController,\r\n              public notificationsProviders: NotificationsProvider) {\r\n\r\n    this.pageData = this.navParams.get('pageData');\r\n  }\r\n\r\n  ionViewWillLoad() {\r\n    if (!this.userLocal)\r\n      this.userLocal = JSON.parse(localStorage.getItem('userLocalData'));\r\n\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad ReserveShelfPage');\r\n\r\n    //if (this.pageData.close == 0) {\r\n    this.showLoader = true;\r\n    console.log('%c%s', 'font-size:20px', 'shelf status is pending');\r\n    this.getShelf(this.pageData.url, this.pageData.user_id);\r\n    //}\r\n    console.log(this.salesPercentage);\r\n    if (this.pageData.status == 0) { // check if the notification had read or not\r\n      this.notificationsProviders.updatereadNotify(this.pageData.id, this.pageData.user_id)\r\n\r\n        .subscribe(res => { // in developing only\r\n          console.log(res);\r\n        })\r\n    } else {\r\n      console.info('you have been read this notification')\r\n    }\r\n\r\n  }\r\n\r\n  getShelf(shelfRequestId, user_id) {\r\n\r\n    this.shelfProvider.getShelfRequestInfo(shelfRequestId, user_id)\r\n      .subscribe(\r\n        ({status, data}) => {\r\n\r\n          if (status == 'success') {\r\n            this.showShelfList = true;\r\n            this.shelfData = data;\r\n\r\n            console.log(this.shelfData, this.pageData);\r\n          } else {\r\n            this.showLoader = false;\r\n            this.noShelf = true;\r\n          }\r\n\r\n        },\r\n        err => {\r\n          console.warn(err)\r\n        },\r\n        () => {\r\n          this.showLoader = false;\r\n        }\r\n      )\r\n  }\r\n\r\n  sendPercentage() {\r\n    // the case when the store will ask for a sale percentage\r\n    const salesPercentage = (this.salesPercentage) ? this.salesPercentage : 0;\r\n    let percentageData = {\r\n      'receive_user_id': this.pageData.send_user_id,\r\n      'user_id': this.pageData.user_id,\r\n      'url': this.pageData.url,\r\n      'name': this.shelfData.name,\r\n      'sale_percentage': salesPercentage\r\n    };\r\n    console.log(this.salesPercentage);\r\n\r\n    this.shelfProvider.addShelfPercentage(percentageData)\r\n      .subscribe(({status, errors}) => {\r\n          if (status == 'success') {\r\n\r\n            this.showToast(`لقد تم ارسال طلب  نسبة المبيعات الى ${this.pageData.name}`);\r\n            this.navCtrl.pop();\r\n          } else {\r\n            this.showToast('لم يتم ارسال طلبك');\r\n            console.log(errors)\r\n          }\r\n\r\n        },\r\n        err => {\r\n\r\n          this.showToast('التطبيق يتطلب اتصال بالانترنت');\r\n          console.warn(err);\r\n\r\n        })\r\n\r\n  }\r\n\r\n  sendReplyRequest(accept: boolean = true): void {\r\n\r\n    if (this.userLocal.level_id == 2) { // this case when the store will reply directly to the shelf reserve request either accept or refuse\r\n\r\n      if (this.shelfData) {\r\n        let requestData = {\r\n          'receive_user_id': this.pageData.send_user_id,\r\n          'user_id': this.pageData.user_id,\r\n          'url': this.pageData.url,\r\n          'name': this.shelfData.name\r\n        };\r\n        let toServer = (accept) ? this.shelfProvider.acceptRequest(requestData) : this.shelfProvider.refuseRequest(requestData);\r\n        toServer.subscribe(({status}) => {\r\n            let acceptStatus = (accept) ? 'الموافقة' : 'الرفض';\r\n            if (status == 'success') {\r\n              this.showToast(`لقد تم ارسال طلب ${acceptStatus} الى ${this.pageData.name}`);\r\n              this.navCtrl.pop();\r\n            }\r\n          }, err => {\r\n            console.warn(err);\r\n            this.showToast('التطبيق يتطلب اتصال بالانترنت');\r\n          }\r\n        )\r\n\r\n      } else {\r\n        console.log('%c%s', 'font-size: 22px;color: cyan', 'لا يوجد رفوف من قاعدة البيانات خاصة بهذا العضو')\r\n      }\r\n\r\n\r\n    } else { // this case the exporter will press the buttons to accept or refuse the store sales percentage proposed\r\n      let requestData = {\r\n        'receive_user_id': this.pageData.send_user_id,\r\n        'user_id': this.pageData.user_id,\r\n        'url': this.pageData.url,\r\n        'name': this.shelfData.name\r\n      };\r\n      this.shelfProvider.acceptPercenatge(requestData, accept)\r\n        .subscribe(({status, data}) => {\r\n          let acceptMsg = accept ? 'موافقة' : 'رفض';\r\n          console.log(status, data);\r\n          if (status == 'success') {\r\n            this.showToast(`لقد تم ارسال ردك بال${acceptMsg} الى ${this.pageData.name}`);\r\n            this.navCtrl.pop();\r\n          } else {\r\n            this.showToast('حاول مرة اخرى')\r\n          }\r\n\r\n        }, err => {\r\n          console.warn(err);\r\n          this.showToast('التطبيق يتطلب اتصال بالانترنت');\r\n        })\r\n\r\n    }\r\n\r\n  }\r\n\r\n  showToast(msg) {\r\n    let toast = this.toastCtrl.create({\r\n      message: msg,\r\n      duration: 3000,\r\n      position: 'top'\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n  navigateToPage(page, user_id) {\r\n    let id = this.pageData.user_id;\r\n    this.navCtrl.push(page, {userData: [user_id, id]})\r\n  }\r\n  imagePath(img) {\r\n    return 'http://rfapp.net/templates/default/uploads/avatars/'+img\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/reserve-shelf/reserve-shelf.ts"],"sourceRoot":""}