{"version":3,"sources":["../../src/pages/notificationspages/notification-delevery-req/notification-delevery-req.module.ts","../../src/pages/notificationspages/notification-delevery-req/notification-delevery-req.ts"],"names":[],"mappings":"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","file":"24.js","sourcesContent":["import { HsaloaderComponentModule } from '../../../components/hsa-loader/hsa-loader.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { NotificationDeleveryReqPage } from './notification-delevery-req';\r\nimport { SinceDatePipeModule } from '../../../app/service/since-date/since-date.module';\r\n@NgModule({\r\n  declarations: [\r\n    NotificationDeleveryReqPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(NotificationDeleveryReqPage),\r\n    SinceDatePipeModule,\r\n    HsaloaderComponentModule\r\n  ],\r\n  exports: [\r\n    NotificationDeleveryReqPage\r\n  ]\r\n})\r\nexport class NotificationDeleveryReqPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notificationspages/notification-delevery-req/notification-delevery-req.module.ts","import { ProductModal } from '../../productmodal';\r\nimport { NotificationsProvider } from '../../../providers/notifications';\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController, ToastController, NavParams, ModalController } from 'ionic-angular';\r\n\r\nimport { INotification, IDeliveryNotifyInfo } from './../../../app/service/interfaces';\r\nimport { DeliveryProvider } from \"../../../providers/delivery\";\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-notification-delevery-req',\r\n  templateUrl: 'notification-delevery-req.html',\r\n})\r\nexport class NotificationDeleveryReqPage {\r\n  pageData: INotification;\r\n  DeliverData: IDeliveryNotifyInfo;\r\n  userLocal = JSON.parse(localStorage.getItem('userLocalData'));\r\n  noDeliveryData: boolean = false;\r\n  showDeliveryInfo: boolean = false;\r\n  showLoader: boolean = true;\r\n  showRefuseMsg: boolean = false;\r\n  refuseMsg: any = '';\r\n  constructor(public navCtrl: NavController,\r\n    public toastCtrl: ToastController,\r\n    public navParams: NavParams,\r\n    public modalCtrl: ModalController,\r\n    public deliveryProvider: DeliveryProvider,\r\n    public notificationProvider:NotificationsProvider\r\n  ) {\r\n\r\n    this.pageData = this.navParams.get('pageData');\r\n\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    if (!this.userLocal)\r\n      this.userLocal = JSON.parse(localStorage.getItem('userLocalData'));\r\n\r\n    this.getRequestInfo();\r\n\r\n    if (this.pageData.status == 0) {\r\n      this.notificationProvider.updatereadNotify(this.pageData.id, this.pageData.user_id)\r\n        .subscribe(res=>{\r\n          console.log(res);\r\n        })\r\n\r\n    } else {\r\n      console.info('you have been read this notification')\r\n    }\r\n  }\r\n\r\n  getRequestInfo() {\r\n    let requestData = {\r\n      delivery_request_id: this.pageData.url,\r\n      user_id: this.pageData.user_id\r\n    };\r\n    this.deliveryProvider.getRequestDeliveryInfo(requestData)\r\n      .subscribe(({ status, data }) => {\r\n        if (status == 'success') {\r\n          this.showDeliveryInfo = true;\r\n          this.DeliverData = data;\r\n        } else {\r\n          this.showDeliveryInfo = false;\r\n          this.noDeliveryData = true;\r\n        }\r\n      },\r\n      err => {\r\n        [this.noDeliveryData] = [true];\r\n        console.warn(err);\r\n        this.showToast('التطبيق يتطلب اتصال بالانترنت. ')\r\n      },\r\n      () => {\r\n        this.showLoader = false\r\n      }\r\n      )\r\n  }\r\n\r\n  navigateToPage(page, user_id) {\r\n    let id = this.pageData.user_id;\r\n    this.navCtrl.push(page, { userData: [user_id, id] })\r\n  }\r\n\r\n  showToast(msg) {\r\n    let toast = this.toastCtrl.create({\r\n      message: msg,\r\n      duration: 3000,\r\n      position: 'top'\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n\r\n  sendReplyRequest(accept: boolean = true) {\r\n    if (this.userLocal.level_id == 2) {\r\n\r\n      if (accept) {\r\n        let requestData = {\r\n          'receive_user_id': this.pageData.send_user_id,\r\n          'user_id': this.pageData.user_id,\r\n          'url': this.pageData.url,\r\n          'shelf_name': this.DeliverData.name\r\n        };\r\n        this.deliveryProvider.acceptDeliveryRequest(requestData) .subscribe(\r\n          ({ status, data }) => {\r\n            console.log(status, data);\r\n            if (status == 'success') {\r\n              this.showToast(`لقد تم ارسال سبب موافقتك بطلب التسليم الى ${this.pageData.name}`);\r\n              setTimeout(() => {\r\n                this.navCtrl.pop()\r\n              }, 2000);\r\n            } else {\r\n              console.log('حاول مجددا')\r\n            }\r\n          },\r\n          err => {\r\n\r\n            console.warn(err);\r\n            this.showToast('التطبيق يتطلب اتصال بالانترنت. تفقد الاتصال وحاول مجددا')\r\n          }\r\n        )\r\n      } else {\r\n\r\n        this.showRefuseMsg = true;\r\n        console.log('refuse message', this.refuseMsg);\r\n        if (this.refuseMsg && this.refuseMsg.trim() != '') {\r\n          let requestData = {\r\n            'receive_user_id': this.pageData.send_user_id,\r\n            'user_id': this.pageData.user_id,\r\n            'url': this.pageData.url,\r\n            'shelf_name': this.DeliverData.name,\r\n            'delivery_message': this.refuseMsg\r\n          };\r\n          this.deliveryProvider.refuseDeliveryRequest(requestData).subscribe(\r\n            ({ status, data }) => {\r\n              console.log(status, data);\r\n              if (status == 'success') {\r\n                this.showToast(`لقد تم ارسال سبب الرفض الى ${this.pageData.name}`);\r\n                setTimeout(() => {\r\n                  this.navCtrl.pop()\r\n                }, 2000);\r\n              } else {\r\n                console.log('حاول مجددا')\r\n              }\r\n            },\r\n            err => {\r\n              console.warn(err);\r\n              this.showToast('التطبيق يتطلب اتصال بالانترنت')\r\n            }\r\n          )\r\n\r\n        } else {\r\n          this.showToast('يرجى ادخال سبب للرفض ليتم ارساله الى المورد')\r\n        }\r\n\r\n      }\r\n    } else {\r\n        return false;\r\n    }\r\n  }\r\n\r\n  openProduct(pageData) {\r\n    let modal = this.modalCtrl.create(ProductModal, {pageData});\r\n\r\n    modal.present()\r\n  }\r\n\r\n  imagePath(img) {\r\n    return 'http://rfapp.net/templates/default/uploads/avatars/'+img\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notificationspages/notification-delevery-req/notification-delevery-req.ts"],"sourceRoot":""}