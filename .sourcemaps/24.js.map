{"version":3,"sources":["../../src/pages/notificationspages/notification-due/notification-due.module.ts","../../src/pages/notificationspages/notification-due/notification-due.ts"],"names":[],"mappings":"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","file":"24.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { NotificationDuePage } from './notification-due';\r\nimport { MomentModule } from 'angular2-moment';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    NotificationDuePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(NotificationDuePage),\r\n    MomentModule\r\n  ],\r\n})\r\nexport class NotificationDuePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notificationspages/notification-due/notification-due.module.ts","import { DueDetails,EDueStatus } from './../../../app/service/interfaces';\r\nimport { DuesProvider } from './../../../providers/dues';\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ToastController } from 'ionic-angular';\r\nimport {NotificationsProvider} from \"../../../providers/notifications\";\r\n\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-notification-due',\r\n  templateUrl: 'notification-due.html',\r\n})\r\nexport class NotificationDuePage {\r\n  pageData: any;\r\n  dueMsg:string = '';\r\n  showMsg: boolean = false;\r\n  DueDetails: DueDetails;\r\n  netErr: boolean = false;\r\n  acceptLoader: boolean = false;\r\n  refuseLoader: boolean = false;\r\n  isDisabled: boolean = false;\r\n  constructor(public navCtrl: NavController,\r\n     public navParams: NavParams,\r\n     private dueProvider: DuesProvider,\r\n     public toastCtrl:ToastController,\r\n              private notificationsProviders: NotificationsProvider\r\n    ) {\r\n\r\n    this.pageData = this.navParams.get('pageData');\r\n    console.log(`pageData >>> ${JSON.stringify(this.pageData)}`)\r\n    //alert(JSON.stringify(this.pageData));\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    if (this.pageData.push == 'true') {\r\n      //alert(JSON.stringify(this.pageData));\r\n      this.notificationsProviders.getNotificationById(this.pageData.id).subscribe(\r\n        ({data}) => {\r\n          //alert(JSON.stringify(data));\r\n          if (data) {\r\n              this.pageData = data;\r\n              console.log('notification details', this.pageData);\r\n              this.getDueByID();\r\n              \r\n          }\r\n        },\r\n        (err) => {\r\n            console.warn(err);\r\n        },\r\n        () => {\r\n        })\r\n    }else{\r\n      console.log('notification details no push', this.pageData);\r\n      this.getDueByID();\r\n    }\r\n  }\r\n  \r\n  getDueByID(){\r\n\r\n    let {url, user_id, id} = this.pageData;\r\n    \r\n    console.log(this.pageData);\r\n\r\n    (this.pageData.status == 0)?this.updateRead(id, user_id):console.info('you have been read this notification')\r\n    this.dueProvider\r\n      .getDueById({url, user_id})\r\n      .retry(3)\r\n      .subscribe(({status, data})=>{\r\n        if (status === 'success') {\r\n          this.DueDetails = data;\r\n          \r\n          console.log('Due Details',this.DueDetails);\r\n        } else {\r\n          \r\n        }\r\n      },\r\n      err=>{\r\n        console.warn(err);\r\n        this.netErr = true;\r\n    })\r\n  }\r\n\r\n  updateRead(id, user_id) {\r\n    this.notificationsProviders\r\n    .updatereadNotify(id, user_id)\r\n    .subscribe(res => { // in developing only\r\n      console.log(res);\r\n    })\r\n  }\r\n\r\n  acceptRequest() {\r\n    setTimeout(() => {\r\n      this.isDisabled = false; // enable button after 5 second\r\n      }, 5000);\r\n\r\n    this.isDisabled = true; // to disable send button for 5 second\r\n    this.acceptLoader = true;\r\n    let duedata = {\r\n      user_id: this.pageData.user_id,\r\n      receive_user_id: this.pageData.send_user_id,\r\n      url: this.pageData.url\r\n    }\r\n    console.log('due data send to DB', duedata)\r\n    this.dueProvider\r\n      .acceptRequest(duedata)\r\n      .debounceTime(1500)\r\n      .subscribe(({status})=>{\r\n        if (status === 'success') {\r\n          this.showToast('تم ارسال ردك بنجاح');\r\n          setTimeout(()=>{\r\n            this.navCtrl.pop();\r\n          }, 1500);\r\n        } else {\r\n          this.showToast('الرجاء المحاولة مرة اخرى')\r\n        }\r\n      },err => {\r\n        this.acceptLoader = false\r\n        this.isDisabled = false;\r\n        console.warn(err);\r\n        this.showToast('التطبيق يتطلب اتصال بالانترنت. تفقد الاتصال وحاول مجددا')\r\n      },() => {\r\n        this.acceptLoader = false\r\n        this.isDisabled = false;\r\n      })\r\n  }\r\n  refuseRequest() {\r\n    setTimeout(() => {\r\n      this.isDisabled = false; // enable button after 5 second\r\n      }, 5000);\r\n\r\n    this.isDisabled = true; // to disable send button for 5 second\r\n    this.refuseLoader = true;\r\n    this.showMsg = true;\r\n      if (this.dueMsg && this.dueMsg.trim() != '') {\r\n      let duedata = {\r\n        user_id: this.pageData.user_id,\r\n        receive_user_id: this.pageData.send_user_id,\r\n        url: this.pageData.url,\r\n        due_message: this.dueMsg.replace(/\\n/g,'<br><br>')\r\n      }\r\n\r\n      this.dueProvider\r\n        .refuseRequest(duedata)\r\n        .debounceTime(1500)\r\n        .subscribe(({status})=>{\r\n          if (status === 'success') {\r\n            this.showToast('تم ارسال ردك بنجاح');\r\n            setTimeout(()=>{\r\n              this.navCtrl.pop();\r\n            }, 1500);\r\n          } else {\r\n            this.showToast('الرجاء المحاولة مرة اخرى')\r\n          }\r\n        },\r\n        err => {\r\n          this.refuseLoader = false\r\n          this.isDisabled = false;\r\n          console.warn(err);\r\n          this.showToast('التطبيق يتطلب اتصال بالانترنت. تفقد الاتصال وحاول مجددا')\r\n        },() => {\r\n          this.refuseLoader = false\r\n          this.isDisabled = false;\r\n        })\r\n      } else {\r\n        this.refuseLoader = false\r\n        this.isDisabled = false;\r\n        this.showToast('يرجى ادخال رسالة الرفض')\r\n      }\r\n  }\r\n\r\n\r\n  showToast(msg) {\r\n    let toast = this.toastCtrl.create({\r\n      message: msg,\r\n      duration: 2000,\r\n      position:'top'\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n  imagePath(img) {\r\n    return 'http://rfapp.net/templates/default/uploads/avatars/'+img\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notificationspages/notification-due/notification-due.ts"],"sourceRoot":""}