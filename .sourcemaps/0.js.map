{"version":3,"sources":["../../src/pages/notificationspages/ownerduerequest/ownerduerequest.module.ts","../../src/pages/notificationspages/ownerduerequest/ownerduerequest.ts","../../src/app/service/InewUserData.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { OwnerduerequestPage } from './ownerduerequest';\r\nimport { MomentModule } from 'angular2-moment';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    OwnerduerequestPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(OwnerduerequestPage),\r\n    MomentModule\r\n  ],\r\n})\r\nexport class OwnerduerequestPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notificationspages/ownerduerequest/ownerduerequest.module.ts","import { NotificationsProvider } from './../../../providers/notifications';\r\nimport { INotification } from './../../../app/service/interfaces';\r\nimport { DuesProvider } from './../../../providers/dues';\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ToastController } from 'ionic-angular';\r\nimport { IlevelId } from '../../../app/service/InewUserData';\r\n\r\n/**\r\n * Generated class for the OwnerduerequestPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-ownerduerequest',\r\n  templateUrl: 'ownerduerequest.html',\r\n})\r\nexport class OwnerduerequestPage {\r\n  userLevel: number = JSON.parse(localStorage.getItem('userLocalData')).level_id;\r\n  pageData: INotification;\r\n  dueDetails: any;\r\n  isStrore: boolean = false;\r\n  showRefuseMsg: boolean = false;\r\n  refuseMsg: string = \"\";\r\n  constructor(public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    public duesProvider: DuesProvider,\r\n    public toastCtrl: ToastController,\r\n    public notificationProvider: NotificationsProvider\r\n  ) {\r\n    \r\n    \r\n    this.pageData = this.navParams.get('pageData');\r\n\r\n    console.log('pageDate from notification page', this.pageData);\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    if (!this.userLevel)\r\n      this.userLevel = JSON.parse(localStorage.getItem('userLocalData')).level_id;\r\n    \r\n    \r\n    this.isStrore = this.userLevel == IlevelId.store;\r\n    console.log('user level Id' , this.userLevel, (this.userLevel == IlevelId.store)?'store':'transporter');\r\n  }\r\n\r\n\r\n  ionViewDidLoad() {\r\n    \r\n    this.getDueDetails()\r\n    \r\n    this.updateNotificationStatus();\r\n    \r\n  }\r\n\r\n  private getDueDetails() {\r\n    const due = { user_id: this.pageData.user_id, url: this.pageData.url }\r\n    this.duesProvider\r\n      .getOwnerDuesById(due)\r\n      .subscribe(({ data, status, errors }) => {\r\n        console.log(data, status, errors);\r\n        this.dueDetails = data;\r\n      });\r\n  }\r\n\r\n  private updateNotificationStatus() {\r\n    if (this.pageData.status == 0) {\r\n      this.notificationProvider.updatereadNotify(this.pageData.id, this.pageData.user_id)\r\n        .subscribe(res => {\r\n          console.log(res);\r\n        })\r\n\r\n    } else {\r\n      console.info('you have been read this notification')\r\n    }\r\n  }\r\n\r\n  sendReplyRequest(accept: boolean = true, msg?:string) {\r\n    \r\n    let due:any = {\r\n      'receive_user_id': this.pageData.send_user_id,\r\n      'user_id': this.pageData.user_id,\r\n      'url': this.pageData.url\r\n    };\r\n\r\n    if (!accept) due.due_message = msg \r\n\r\n    let sendRequest = accept ? this.duesProvider.acceptRequest(due, true) : this.duesProvider.refuseRequest(due, true);\r\n\r\n\r\n    sendRequest.subscribe(({ status }) => {\r\n      let acceptStatus = (accept) ? 'الموافقة' : 'الرفض';\r\n      if (status == 'success') {\r\n        this.showToast(`لقد تم ارسال  ${acceptStatus} الى الادارة`);\r\n        this.navCtrl.pop();\r\n      }\r\n    }, err => {\r\n      console.warn(err);\r\n      this.showToast('التطبيق يتطلب اتصال بالانترنت');\r\n    })\r\n\r\n\r\n\r\n  }\r\n\r\n  sendRefuseMsg() {\r\n    if (this.showRefuseMsg) {\r\n      \r\n      console.log('you are about to send refuse message to the admin');\r\n\r\n      if (this.refuseMsg && this.refuseMsg.trim()) {\r\n        this.sendReplyRequest(false,this.refuseMsg)\r\n      } else {\r\n        this.showToast('يرجى ادخال سبب الرفض اولاً');\r\n        this.refuseMsg = '';\r\n      }\r\n\r\n    } else {\r\n\r\n      this.showRefuseMsg = true;\r\n    }\r\n  }\r\n\r\n  imagePath(img) {\r\n    return 'http://rfapp.net/templates/default/uploads/avatars/' + img\r\n  }\r\n\r\n  showToast(msg) {\r\n    let toast = this.toastCtrl.create({\r\n      message: msg,\r\n      duration: 3000,\r\n      position: 'top'\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notificationspages/ownerduerequest/ownerduerequest.ts","export enum IlevelId {\r\n  store = 2,\r\n  exporter,\r\n  client\r\n}\r\nexport enum levelToAr {\r\n  'متجر'= 2,\r\n  'مورد',\r\n  'عميل'\r\n}\r\n\r\nexport interface ImodalData {\r\n  areaId?: number,\r\n  areaName?: string,\r\n  cityId?: number,\r\n  cityName?:string,\r\n  distId?: number,\r\n  distName?: string\r\n}\r\nexport interface Iplace {\r\n  id: number,\r\n  name: string,\r\n  parent: number,\r\n  parent_name: string| null\r\n}\r\nexport interface IuserData{\r\n  apiKey: string,\r\n  Name: string,\r\n  Username: string,\r\n  Email:string,\r\n  Mobile: string,\r\n  Gender: string,\r\n  Address:string,\r\n  Map: string,\r\n  Area: number,\r\n  City: number,\r\n  Dist: number,\r\n  level_id: number,\r\n  commercialRegisterId?: number,\r\n  directorProductName?: string\r\n}\r\n\r\nexport interface IlocalUser{\r\n  username: string,\r\n  name: string,\r\n  id: number,\r\n  level_id: number,\r\n  active: number,\r\n  address: string,\r\n  area: number,\r\n  areaName?: string,\r\n  city: number,\r\n  cityName?: string,\r\n  dist: number,\r\n  distName?: string,\r\n  email: string,\r\n  gender: string,\r\n  mobile: string,\r\n  avatar: string,\r\n  latitude: string,\r\n  longitude: string,\r\n  cover?: string,\r\n  owner_name?: string,\r\n  cr_num?: number,\r\n  map: string,\r\n  followers?: number,\r\n  followings?: number,\r\n  follow?: boolean | any,\r\n  device_token_id?:string\r\n}\r\n\r\nexport interface Ishelf {\r\n  area: number,\r\n  close: number,\r\n  cost: number,\r\n  id: number,\r\n  name: string,\r\n  user_id: number,\r\n  data_added?: Date,\r\n  data_modified?: Date,\r\n  shelf_status?: number,\r\n  start_date?: any,\r\n  end_date?: any,\r\n  shelf_name?: string,\r\n  matger_id?:number,\r\n  matger_name?:string\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/service/InewUserData.ts"],"sourceRoot":""}