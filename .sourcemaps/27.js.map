{"version":3,"sources":["../../src/pages/messages/showmessage/showmessage.module.ts","../../src/pages/messages/showmessage/showmessage.ts"],"names":[],"mappings":"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","file":"27.js","sourcesContent":["import { ArabicDatePipeModule } from './../../../app/service/arabic-date/arabic-date.module';\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ShowmessagePage } from './showmessage';\r\nimport {SinceDatePipeModule} from \"../../../app/service/since-date/since-date.module\";\r\nimport {HsaloaderComponentModule} from \"../../../components/hsa-loader/hsa-loader.module\";\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ShowmessagePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ShowmessagePage),\r\n    HsaloaderComponentModule,\r\n    SinceDatePipeModule,\r\n    ArabicDatePipeModule\r\n  ],\r\n})\r\nexport class ShowmessagePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/messages/showmessage/showmessage.module.ts","import {IlocalUser, INotificationMessage} from './../../../app/service/interfaces';\r\nimport { Component, ViewChild, ElementRef } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ToastController } from 'ionic-angular';\r\nimport {MessagesProvider} from \"../../../providers/messagesprovider\";\r\n\r\n/**\r\n * Generated class for the ShowmessagePage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-showmessage',\r\n  templateUrl: 'showmessage.html',\r\n})\r\nexport class ShowmessagePage {\r\n  @ViewChild('mailbody') mailbody:ElementRef;\r\n  messageId:any;\r\n  pageData: INotificationMessage;\r\n  messageReplies: any[];\r\n  localUser: IlocalUser = JSON.parse(localStorage.getItem('userLocalData'));\r\n  showLoader:boolean = false;\r\n  constructor(public navCtrl: NavController,\r\n     public navParams: NavParams,\r\n     public messagesProvider: MessagesProvider,\r\n     public toastCtrl: ToastController\r\n    ) {\r\n    //this.messageId = this.navParams.get('messageData');\r\n    this.pageData  = this.navParams.get('messageData');\r\n\r\n    console.log(this.pageData);\r\n\r\n\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    if (!this.localUser) {\r\n      this.localUser= JSON.parse(localStorage.getItem('userLocalData'));\r\n    }\r\n\r\n\r\n    console.log('ionViewDidLoad ShowmessagePage');\r\n    this.getMessageDetails(this.pageData.id);\r\n    if (this.pageData.status == 0) {\r\n      this.readMail();\r\n    } else {\r\n      console.log('you have read this email');\r\n\r\n    }\r\n  }\r\n\r\n  readMail() {\r\n    this.messagesProvider.readMessage(this.pageData.id, this.pageData.user_id)\r\n      .subscribe(res=>{\r\n        console.log(res);\r\n      })\r\n  }\r\n\r\n  reply(message) {\r\n\r\n    if (message && message.trim() != '') {\r\n      let messageData: INotificationMessage|any = {\r\n        user_id: this.localUser.id,\r\n        mail_body: message.replace(/\\n/g, '<br><br>'),\r\n        mail_title: this.pageData.mail_title,\r\n        receive_user_id: this.pageData.user_id,\r\n        parent_id: this.pageData.id\r\n      };\r\n      this.showLoader = true;\r\n      this.messagesProvider.sendMessage(messageData)\r\n        .subscribe(({status, data})=> {\r\n          if (status == 'success') {\r\n            this.showToast('تم ارسال ردك بنجاح');\r\n            messageData.name = this.localUser.name;\r\n            messageData.avatar = this.localUser.avatar;\r\n            messageData.showBody = true;\r\n            messageData.date_added = Date.now();\r\n            this.messageReplies.push(messageData);\r\n            this.mailbody.nativeElement.style.height = '50px';   \r\n          }\r\n        },\r\n        err=> {\r\n          console.warn(err);\r\n          this.showLoader = false;\r\n          this.showToast('التطبيق يتطلب اتصال بالانترنت');\r\n        },\r\n        () => {\r\n          this.showLoader = false;\r\n\r\n        }\r\n      )\r\n    }\r\n  }\r\n    getMessageDetails(id){\r\n      this.messagesProvider.getMessageDetails(id)\r\n        .subscribe(({status, data}) => {\r\n          console.log('message Details', data);\r\n          if (status == 'success') {\r\n            data.replays.forEach((x,i,a)=>(i !=(a.length-1))? x.showBody = false:x.showBody=true);\r\n            this.messageReplies = data.replays\r\n          }\r\n\r\n        }, err => {\r\n          console.warn(err);\r\n        })\r\n\r\n  }\r\n\r\n\r\n  getMessage(id) {\r\n    this.messagesProvider.getMessage(id)\r\n      .subscribe(\r\n        res=> {\r\n          console.log(res);\r\n\r\n        },\r\n        err => {\r\n          console.warn(err)\r\n        }\r\n      )\r\n  }\r\n\r\n  navigateToPage(reciever, reciever_id) {\r\n    this.navCtrl.push('MessagePage', { reciever,reciever_id})\r\n  }\r\n\r\n\r\n  openProfile() {\r\n    let localUserId = JSON.parse(localStorage.getItem('userLocalData')).id;\r\n    this.navCtrl.push('VprofilePage', {pageData: [this.pageData.user_id, localUserId]})\r\n  }\r\n\r\n  showToast(msg) {\r\n    this.toastCtrl.create({\r\n      message:msg,\r\n      duration: 2000\r\n    }).present();\r\n  }\r\n\r\n  watchHeight(event) {\r\n\r\n    const textArea = this.mailbody.nativeElement;\r\n\r\n    console.log(this.mailbody);\r\n    \r\n\r\n    textArea.style.height = 'auto';\r\n\r\n    if (textArea.scrollHeight < 200) {\r\n      textArea.style.height = textArea.scrollHeight + 'px';    \r\n    } else {\r\n      textArea.style.height = '200px';\r\n    }\r\n  }\r\n  imagePath(img) {\r\n    return 'http://rfapp.net/templates/default/uploads/avatars/'+img\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/messages/showmessage/showmessage.ts"],"sourceRoot":""}