<ion-header>
  <ion-navbar color="primary">
    <ion-title>
      صفحتى </ion-title>
  </ion-navbar>
</ion-header>

<ion-content>




  <ion-card *ngIf="userLocal" id="user-info">
    <section  id="hero">
      <img *ngIf="userLocal.bgImage" [src]="userLocal.bgImage" alt="user background image">
      <button type="button" class="pick-image" (click)="pickImage('bgImage')"><ion-icon name="camera-outline"></ion-icon></button>
    </section>

    <ion-card>
      <ion-grid>
        <ion-row>

        <ion-col col-3>

          <ion-avatar>
             <button type="button" class="pick-image" (click)="pickImage('avatar')">
               <ion-icon name="camera-outline"></ion-icon>
              </button>
              <img *ngIf="userLocal.avatar;else avatarIcon" [src]="userLocal.avatar" alt="">
              <ng-template #avatarIcon>
                  <img class="avatar-alt" *ngIf="userLocal.gender == 'male'" width="70" src="assets/img/male-alt.png">

                  <img class="avatar-alt" *ngIf="userLocal.gender == 'female'" width="70" src="assets/img/female-alt.png">
              </ng-template>

          </ion-avatar>
          <div class="clearfix"></div>
        </ion-col>

        <ion-col>
          <h4>{{userLocal.name}}</h4>
          <div id="rank">
            <ion-icon name="star" color="light"></ion-icon>
            <ion-icon name="star" color="light"></ion-icon>
            <ion-icon name="star" color="light"></ion-icon>
            <ion-icon name="star" color="light"></ion-icon>
            <ion-icon name="star-outline" color="light"></ion-icon>
            &nbsp;
            <span class="user-rank">4</span> / 5
          </div>
          <div id="profile-buttons">

            <button ion-button color="primary" small outline>
              <ion-icon name="person"></ion-icon>
             متابعة
        </button>

            <button ion-button color="primary" small outline (click)="navigateToPage('MessagePage', 'messageData', userLocal.name)">
              <ion-icon name="chatboxes"></ion-icon>
           راسلنا
          </button>
          </div>

        </ion-col>

        </ion-row>
      </ion-grid>

        <div id="profile-follow">
          <a  color="primary" (click)="navigateToPage('FollowingsPage')">
                      <ion-icon name="people"></ion-icon>
                      المتابِعون

                      <span class="following">154</span>
                      </a>

          <a color="primary" (click)="navigateToPage('FollowersPage')">
                      <ion-icon name="people"></ion-icon>
                      المتابَعون                      <span class="followers">113</span>

                    </a>
        </div>


        <div id="page-segments" padding>
          <ion-segment [(ngModel)]="showContent">

            <ion-segment-button value="products">
              المنتجات
            </ion-segment-button>

            <ion-segment-button value="shelfs" >
              الرفوف
            </ion-segment-button>
          </ion-segment>
      </div>



    </ion-card>

  </ion-card>
  <div class="clearfix"></div>
  <ion-card  *ngIf="showContent == 'shelfs' && userLocal" class="show-card shelfcard">

    
          <!-- add loADER -->
          <!--<ion-scroll scrollY="true">

          
          <ion-refresher (ionRefresh)="refreshShelfs($event)">
              <hsa-loader></hsa-loader>
          </ion-refresher>

          </ion-scroll> -->

    <ion-list>

        <p text-center *ngIf="noShelfs=='empty'">
          <br>
             لم يتم اضافة رفوف حتى الان
        </p>
        <p text-center *ngIf="noShelfs =='netErr'">
         <br>
          تعثر الاتصال الرجاء المحاولة فى وقت لاحق
         <br>
        <!-- <span [change]="{prop:'font-size', value: '30px'}" text-center><ion-icon name="refresh"></ion-icon></span>-->
        </p>
        
        <ion-item  *ngFor="let shelf of AllShelfs; let i = index" >
            <div class="shelf-id" (click)="showShelf(shelf)">
              <p>رقم الرف <span>{{shelf.name}} </span></p>
            </div>
            <hr>
            <div class="shelf-status">
              <div class="reserved">
                <span *ngIf="shelf.close == 0">غير محجوز</span>
                <span *ngIf="shelf.close == 1"> محجوز</span>
                </div>
              <div class="shelf-controls">
                <ion-icon name="open-outline"
                  (click)="editShelf('AddshelfPage', shelf)"
                ></ion-icon>
                <ion-icon
                  name="trash-outline"
                  (click)="deleteShelf(shelf)"
                  ></ion-icon>
              </div>
            </div>
        </ion-item>

        <p text-center *ngIf="showLoader">
          <hsa-loader></hsa-loader>
        </p>

    </ion-list>



  </ion-card>

  <ion-card *ngIf="showContent == 'products' && userLocal" class="show-card products-card">
    
    <!--
    <ion-grid padding-horizontal>
      <ion-row>
        <ion-col col-6>
          <div class="col-content"(click)="navigateToPage('ProductPage', 'I phone 5')">

            <img src="assets/img/product-iphone.png" alt="product">

            <p class="prod-desc">
              ايفون 5 شاشة رام 1 جيجا وذاكرة داخلية 16 جيجا
            </p>
            <p class="price">
              <span class="prod-price"><b>1,500</b></span> ريال
            </p>

    
          </div>

         
        </ion-col>
        <ion-col col-6>
          <div class="col-content" (click)="navigateToPage('ProductPage', 'Mac Book Pro')">

            <img src="assets/img/product-mac.png" alt="product">

            <p class="prod-desc">
              ماك بوك برو رامات 16جيجا هارد 1 تيرا وكات شاشة انفيديا
            </p>
            <p class="price">
              <span class="prod-price"><b>3,500</b></span> ريال
            </p>

          </div>
        </ion-col>


      </ion-row>
    </ion-grid>
    -->

    <p text-center *ngIf="noProducts== 'empty'">
      <br>
      لا يوجد منتجات حتى الان ليتم عرضها
    </p>
    <ion-grid padding-horizontal>
      <ion-row>
        <ion-col col-6 *ngFor="let product of AllProducts;let i = index">
          <div class="col-content"(click)="navigateToPage('ProductPage', product)">

            <img src="assets/img/product-iphone.png" alt="product">

            <p class="prod-desc">
              {{limitString(product.item_desc)}}
            </p>
            <p class="price">
              <span class="prod-price"><b>{{product.item_price}}</b></span> ريال
            </p>

            <!--<a href="">ابلاغ عن مخالفة</a>-->
          </div>

          <div class="prodcut-controls" (click)="showProductSettings($event, product, i)">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
           <ion-list no-lines class="product-settings" hidden [attr.id]='i'>
              <ion-item (click)="editProduct(product)">
                <ion-icon color="primary" name="open-outline" item-left></ion-icon>
                <ion-label>تعديل المنتج</ion-label>
              </ion-item>
              <ion-item (click)="deleteProduct(product)">
                <ion-icon  color="primary" name="trash-outline" item-left> </ion-icon>
                <ion-label>حذف المنتج</ion-label>
              </ion-item>

              <ion-item (click)="navigateToPage('ProductreportPage', product)">
                <ion-icon  color="primary" name="warning-outline" item-left></ion-icon>
                <ion-label>ابلاغ عن المنتج</ion-label>
              </ion-item>
            </ion-list>

        </ion-col>
      </ion-row>
    </ion-grid>
     <p text-center *ngIf="showLoader">
          <hsa-loader></hsa-loader>
        </p>

        <!--
          <ion-infinite-scroll (ionInfinite)="fetchMoreProducts($event)">
            <ion-infinite-scroll-content
              loadingSpinner="bubbles"
              loadingText="جلب مزيد من المنتجات...">
            ></ion-infinite-scroll-content>
          </ion-infinite-scroll>
       
        -->

        {{ cameraError | json}}
  </ion-card>
  <div *ngIf="userLocal">

      <button *ngIf="showContent == 'shelfs' && userLocal['level_id'] == 2" ion-button small (click)="navigateToPage('AddshelfPage')" class="float-button"> أضف رف</button>



    <button *ngIf="showContent == 'products' && userLocal['level_id'] == 3" ion-button small (click)="navigateToPage('AddproductPage')" class="float-button"> أضف منتج</button>
  </div>

  <ion-card id="notLggin" *ngIf="userLocal == null || userLocal == undefined">
    <br><br>
    <p>انت غير مسجل لدينا اذا كنت تملك حساب فقم </p>
    <button ion-button small (click)="navigateToPage('Login')">تسجيل الدخول</button><br>
    <p>او </p>
    <button ion-button small (click)="navigateToPage('Signup')">تسجيل حساب جديد</button>
  </ion-card>
</ion-content>
