<!--
  Generated template for the ShowmessagePage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="primary">
    <ion-title>عرض الرسالة</ion-title>
    <ion-buttons end>
      <ion-spinner *ngIf="showLoader" small name="crescent" color="light"></ion-spinner>
    </ion-buttons>
  </ion-navbar>

</ion-header>


<ion-content>

  <ion-list>
    <!--
    <ion-item no-lines id="hero" (click)="openProfile()">
      <ion-avatar item-left>
        <img *ngIf="pageData.avatar != '' ;else altImages" [src]="imagePath(pageData.avatar)" alt="profile image">
        <ng-template #altImages>
          <img class="alt" *ngIf="pageData.gender == 'female'" src="assets/img/female-alt.png">
          <img class="alt" *ngIf="pageData.gender == 'male'" src="assets/img/male-alt.png">
        </ng-template>
      </ion-avatar>
      <h3 >
        <span>{{ pageData.name }}</span>
        <span class="since-time">منذ
        {{pageData.date_added | sincedate}}
      </span>
      </h3>
    </ion-item>
-->

    <ion-item class="msg">
      <ion-avatar item-left>
        <img *ngIf="pageData.avatar != '' ;else altImages" [src]="imagePath(pageData.avatar)" alt="profile image">
        <ng-template #altImages>
          <img class="alt" *ngIf="pageData.gender == 'female'" src="assets/img/female-alt.png">
          <img class="alt" *ngIf="pageData.gender == 'male'" src="assets/img/male-alt.png">
        </ng-template>
      </ion-avatar>
      <p class="msg-title"> {{pageData.sender_name}} </p>
      <p class="msg-title"> {{pageData.mail_title}} </p>
      <!-- <p class="msg-date"> {{pageData.date_added | date:'longDate' | arabicdate}} </p> -->
      <p class="msg-date"> {{pageData.date_added}} </p>

    </ion-item>
    <div class='msg-body sender-msg'>

      <p>{{pageData.mail_body}}</p>

    </div>

    <div class="msg msg-left me" *ngFor="let reply of messageReplies">
      <ion-item class="msg" (click)="reply.showBody = !reply.showBody">
        <ion-avatar item-left>
          <img *ngIf="reply.avatar != '' ;else altImages" [src]="imagePath(reply.avatar)" alt="profile image">
          <ng-template #altImages>
            <img class="alt" *ngIf="reply.gender == 'female'" src="assets/img/female-alt.png">
            <img class="alt" *ngIf="reply.gender == 'male'" src="assets/img/male-alt.png">
          </ng-template>
        </ion-avatar>
        <ion-icon item-right name="arrow-down" color="lightDark"></ion-icon>
        <p class="msg-title" [innerText]="reply.name==localUser.name?'انا':reply.name"></p>
        <!-- <p class="msg-date"><span>{{reply.date_added | date:'shortTime'}}</span> <span>{{reply.date_added | date:'longDate' | arabicdate}}</span>          </p> -->
        <p class="msg-date">
            <span *ngIf="!reply.new">{{reply.date_added}}</span> 
            <span *ngIf="reply.new">{{reply.date_added|amTimeAgo}}</span> 
        </p>
      </ion-item>
      <div class='msg-body ' [innerHTML]='reply.mail_body' [hidden]='!reply.showBody'>

      </div>
    </div>



  </ion-list>

  <section class="float-btn">
    <textarea #mailbody rows="1" (input)="watchHeight($event)" type="text" placeholder="الرد على الرسالة"></textarea>
    <button ion-button block full (click)="reply(mailbody.value);(mailbody.value)?mailbody.value='':false">رد</button>
  </section>

</ion-content>
